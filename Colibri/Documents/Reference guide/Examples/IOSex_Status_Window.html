<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head><meta content="text/html; charset=ISO-8859-1" http-equiv="content-type"><title>IOSex_Status_Window</title></head>
<body>&nbsp;&nbsp;&nbsp; <a href="file:///D:/Vip_Tools/Colibri/Reference%20Guide.html"><img style="border: 0px solid ; width: 200px; height: 130px;" alt="Colibri" title="Colibri" src="file:///D:/Vip_Tools/Colibri/Documents/Logo/Colibri_full.png"></a>&nbsp;&gt;&nbsp;<a href="../Example%20Code.html">Examples</a><a href="file:///D:/Vip_Tools/Colibri/Documents/Reference%20Guide/Object%20Classes/EOSocImages/EOSocImages.html"></a><h1 style="color: rgb(0, 0, 120);">IOSex_Status_Window</h1><a href="#Syntax">Syntax</a> |&nbsp;<a href="#Arguments">Arguments</a> | <a href="#Keywords">Keywords</a> | <a href="#Example">Example</a> | <a href="#Version_History">Version History</a><br><p>&nbsp;This example procedure demonstrates the use of the class "<a href="../Object%20Classes/IOSocStatus/IOSocStatus.html">IOSocStatus</a>" for creating and managing the status window.</p><h2 style="color: rgb(0, 0, 120);"><a name="Syntax"></a>Syntax</h2>IOSex_Status_Window [, /<a href="#STATUSSCREEN">STATUSSCREEN</a>]<h2 style="color: rgb(0, 0, 120);"><a name="Arguments"></a>Arguments</h2>None.<h2 style="color: rgb(0, 0, 120);"><a name="Keywords"></a>Keywords</h2><h3 style="color: rgb(0, 70, 200);"><a name="STATUSSCREEN"></a>STATUSSCREEN</h3>Set this keyword to display the info in a Status Screen window instead of on the&nbsp;Status Text widget.<h2 style="color: rgb(0, 0, 120);"><a name="Example"></a>Example</h2><p>This example can be found in the Colibri install directory: &lt;Dir:\&gt;...\Colibri\Examples\</p><p><span style="color: rgb(0, 0, 220);">;------------------------------------------------------------------------------------------------------------</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">pro IOSex_STATUS_WINDOW, StatusScreen=StatusScreen</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">;------------------------------------------------------------------------------------------------------------</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; </span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; Module = 'IOSex_STATUS_WINDOW'</span><br style="color: rgb(0, 0, 220);"><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; ;--- Define output directory</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; Log_Dir = ENVI_PICKFILE(/DIRECTORY, TITLE='Locate the directory where to log file needs to be written.')</span><br style="color: rgb(0, 0, 220);"><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; if ~keyword_set(Log_Dir) then return else Log_Dir += '\' </span><br style="color: rgb(0, 0, 220);"><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; ;-- Create the status object. A log file will be written to the test directory on the 'D' drive.</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; ;-- If the directory is not existing it will be created automatically.</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; oStatus = OBJ_NEW('IOSocStatus', LOG_DIRECTORY=Log_Dir, LOG_FILE_PREFIX='LogDemo', $</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp;&nbsp;&nbsp; Title='Status Window Demo', StatusScreen=StatusScreen)</span><br style="color: rgb(0, 0, 220);"><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; ;-- Set the status running.</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; oStatus-&gt;Log_Status, 'Busy', 'Processing started.', Module, /LOG</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; </span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; ;-- Initiate the slow loop.</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; nSlowLoops = 10</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; </span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; for X=0, nSlowLoops-1 do begin</span><br style="color: rgb(0, 0, 220);"><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp;&nbsp;&nbsp; oStatus-&gt;Log_Status, 'Busy', '&nbsp; Entering slow loop: '+strtrim(string(X+1),2)+' of '+ $ </span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strtrim(string(nSlowLoops),2), Module, /LOG</span><br style="color: rgb(0, 0, 220);"><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp;&nbsp;&nbsp; ;-- Report the slow progress.</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp;&nbsp;&nbsp; oStatus-&gt;Progress_set, SLOW=[X, nSlowLoops] </span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; </span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp;&nbsp;&nbsp; ;-- Initiate the fast loop.</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp;&nbsp;&nbsp; nFastLoops = 100000L</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; </span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp;&nbsp;&nbsp; for Y=0L, nFastLoops do begin</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; </span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;-- Report the fast progress.</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oStatus-&gt;Progress_set, FAST=[Y, nFastLoops]</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
wait, 0.0001&nbsp; ; wait 0.1 ms to simulate a certain action and allow
visualisation of the progress.</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp;&nbsp;&nbsp; endfor</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp;&nbsp;&nbsp; </span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp;&nbsp;&nbsp; ;-- clear the fast progress bar.</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp;&nbsp;&nbsp; ostatus-&gt;progress_clear, /FAST</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; endfor&nbsp;&nbsp; </span><br style="color: rgb(0, 0, 220);"><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; wait, 1 ; wait 1 s before resetting the status.</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; </span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; ;-- Set the status running.</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; oStatus-&gt;Log_Status, 'Busy', 'Processing ended.', Module, /LOG</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; </span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; ;-- reset the status.</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; oStatus-&gt;Progress_clear, /RESET</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; </span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; ;-- Post last message</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp; oStatus-&gt;Log_Status, 'Request', 'You can view the log file at: '''+Log_Dir+ $</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ''' after closing this status window.'</span><br style="color: rgb(0, 0, 220);"><span style="color: rgb(0, 0, 220);">end</span></p><h2 style="color: rgb(0, 0, 120);"><a name="Version_History"></a>Version History</h2><table style="text-align: left; width: 100px;" border="0" cellpadding="4" cellspacing="1"><tbody><tr><td style="background-color: rgb(213, 213, 222);"><span style="font-weight: bold;">Author</span></td><td style="background-color: rgb(213, 213, 222);"><span style="font-weight: bold;">Date</span></td><td style="background-color: rgb(213, 213, 222);"><span style="font-weight: bold;">Description</span></td></tr><tr><td style="background-color: rgb(226, 226, 226);"><a href="../Authors%20and%20Contributors.html">LBer</a></td><td style="white-space: nowrap; background-color: rgb(226, 226, 226);">October 2012</td><td style="background-color: rgb(226, 226, 226);">Created</td></tr><tr><td style="background-color: rgb(226, 226, 226);"><a href="../Authors%20and%20Contributors.html">LBer</a></td><td style="background-color: rgb(226, 226, 226); white-space: nowrap;">February 2013</td><td style="background-color: rgb(226, 226, 226); white-space: nowrap;">Status Screen added.</td></tr></tbody></table><p></p></body></html>