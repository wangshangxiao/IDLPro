<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head><meta content="text/html; charset=ISO-8859-1" http-equiv="content-type"><title>EOSap_Smoothing</title></head>
<body>&nbsp;&nbsp;&nbsp; <a href="../../../../../Reference%20Guide.html"><img style="border: 0px solid ; width: 200px; height: 130px;" alt="Colibri" title="Colibri" src="../../../../Logo/Colibri_full.png"></a><a href="../../../../../Reference%20Guide.html"></a>&nbsp;&gt; <a href="../../../Applications.html">Applications</a><br><h1 style="color: rgb(0, 0, 120);">EOSap_Smoothing</h1><a href="#Syntax">Syntax</a> | <a href="#Category">Category</a> | <a href="#Methods">Methods</a> | <a href="#Algorithm">Algorithm</a> | <a href="#Description">Description</a> | <a href="#Reference">Reference</a> | <a href="#Version_History">Version History</a><br><span style="font-weight: bold;"><br></span>This application will perform spectral smoothing of hyperspectral images.<br><br><img style="width: 670px; height: 516px;" alt="Smoothing" title="Smoothing" src="../../../Images/Smoothing.png"><br><h2 style="color: rgb(0, 0, 120);"><a name="Syntax"></a>Syntax</h2>Starting the application from the IDL command line:<br><br>&nbsp;&nbsp;&nbsp; EOSap_Smoothing<br><br>Not yet implemented:<br>The application can also be started from the ENVI main menu or Toolbox under <span style="font-weight: bold; color: rgb(0, 70, 200);">ENVI / IDL code Library</span> &gt; <span style="font-weight: bold; color: rgb(0, 70, 200);">Applications</span> &gt; <span style="font-weight: bold; color: rgb(0, 70, 200);">Hyperspectral</span> &gt; <span style="font-weight: bold; color: rgb(0, 70, 200);">Spectral Smoothing</span>.<br><br><h2 style="color: rgb(0, 0, 120);"><a name="Category"></a>Category</h2>Applications - Hyperspectral<br><h2 style="color: rgb(0, 0, 120);"><a name="Methods"></a>Methods</h2><table style="text-align: left; width: 100%;" border="1" cellpadding="2" cellspacing="2"><tbody><tr><td style="background-color: rgb(213, 213, 222);"><span style="font-weight: bold;">Methods - common</span></td><td style="background-color: rgb(213, 213, 222);"><span style="font-weight: bold;">Description</span></td></tr><tr><td style="background-color: rgb(226, 226, 226);">check_input</td><td style="background-color: rgb(226, 226, 226);">This function method will check the required parameters before the actual smoothing process starts.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">define</td><td style="background-color: rgb(226, 226, 226);">This procedure method defines the 'EOSap_Smoothing' class structure.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">imageviewer_user_info</td><td style="background-color: rgb(226, 226, 226);">This procedure method is called by the&nbsp;'IOSocImageViewer' object to inform the user of the object about an event that occured in the WIDGET_DRAW images window.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">init</td><td style="background-color: rgb(226, 226, 226);">This function method creates and initializes an instance of the class 'EOSap_Smoothing'. The obtained object is used to maintain the smoothing process.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">profileviewer_user_info</td><td style="background-color: rgb(226, 226, 226);">This
procedure method is called by the 'IOScocProfileViewer' object to
inform the user of the object about an event that occured in the
WIDGET_DRAW profile window.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">update_smoothing_factors</td><td style="background-color: rgb(226, 226, 226);">This procedure method is used to update the Smoothing GUI with the new smoothing factors.</td></tr><tr><td style="background-color: rgb(213, 213, 222);"><span style="font-weight: bold;">Methods - handlers</span></td><td style="background-color: rgb(213, 213, 222);"><span style="font-weight: bold;">Description</span></td></tr><tr><td style="background-color: rgb(226, 226, 226);">handle_add_scenario</td><td style="background-color: rgb(226, 226, 226);">This procedure methode is used to add a new smoothing scenario.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">handle_bands_select</td><td style="background-color: rgb(226, 226, 226);">This procedure methode is used to update the Smoothing GUI according the selected bands.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">handle_clear_settings</td><td style="background-color: rgb(226, 226, 226);">This procedure methode is used to clear the smoothing parameters for the selected bands.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">handle_info</td><td style="background-color: rgb(226, 226, 226);">This
procedure methode is used to display the application info. The info
should be present in pdf format located in the ./GUI/HelpFiles/
subdirectory of the corresponding application or in the ./Colibri_help/
subdirectory.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">handle_input_directory</td><td style="background-color: rgb(226, 226, 226);">This procedure methode is used to locate the image files to be smoothed.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">handle_output_directory</td><td style="background-color: rgb(226, 226, 226);">This procedure methode is used to request for the output direcotry were the smoothed results need to be&nbsp;stored.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">handle_remove_scenario</td><td style="background-color: rgb(226, 226, 226);">This procedure methode is used to remove the selected scenario.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">handle_restore_smoothing_params</td><td style="background-color: rgb(226, 226, 226);">This procedure methode is used to restore the smoothing parameters from the specified smoothing&nbsp;parameters text file.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">handle_save_smoothing_params</td><td style="background-color: rgb(226, 226, 226);">This procedure methode is used to save the defined smoothing parameters to the requested smoothing&nbsp;parameters text file.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">handle_scenario_select</td><td style="background-color: rgb(226, 226, 226);">This procedure methode is used to update the GUI with the information for the selected scenario.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">handle_select_all</td><td style="background-color: rgb(226, 226, 226);">This procedure methode is used to update the GUI with all available bands selected.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">handle_select_image_file</td><td style="background-color: rgb(226, 226, 226);">This procedure methode is used to request for the image to be smoothed.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">handle_set_smoothfactor</td><td style="background-color: rgb(226, 226, 226);">This procedure methode is used to set the smoothing factors for the selected wavelengts.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">handle_smf_select</td><td style="background-color: rgb(226, 226, 226);">This procedure methode is used to update the GUI with the wavelength range selected.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">handle_smooth_spectrum</td><td style="background-color: rgb(226, 226, 226);">This procedure methode is used to apply the specified smoothing factors to the soecified spectrum.</td></tr><tr><td style="background-color: rgb(226, 226, 226);">handle_start</td><td style="background-color: rgb(226, 226, 226);">This procedure methode is used to apply the smoothing factors to the selected images.</td></tr></tbody></table><h2 style="color: rgb(0, 0, 120);"><a name="Algorithm"></a>Algorithm</h2>Hyperspectral
images often contain noise or error features due to the limited
accuracy of calibrations, measurements and models that were used during
data collection and processing. Existing smoothing and polishing
algorithms not always lead to a satisfactory result. <br><br>With the
semi interactive smoothing algorithm it is possible to subdivide the
spectrum in discrete groups of wavelengths for which individual
smoothing factors can be defined. By this it is possible to preserve
important or delicate parts of the spectrum, while other parts can be
treated more roughly. <br><br>Nevertheless, extreme care should be
taken as not to introduce additional artefacts. Therefore it&#8217;s
recommended that test runs are made on representative parts of the
hyperspectral image and that the results will be verified very accurate
before final processing is done.<br><br>The smoothing algorithm is
based on the weighted mean of spectral values of neighbouring
wavelengths. Because it&#8217;s possible to subdivide and smooth selected
parts of the spectrum, distinction has to be&nbsp; made between
starting, middle and ending wavelengths of the selected spectral range.
The degree of smoothing is simply accomplished by iterative running the
algorithms the number of times specified in the input. The smoothing
algorithms can be written as :<br><br>Starting wavelength :&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br><div style="margin-left: 120px;"><img style="width: 257px; height: 80px;" alt="Starting wavelength" src="../../../Images/Starting_WL.png"><br></div>Middle wavelength :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br><div style="margin-left: 120px;"><img style="width: 382px; height: 80px;" alt="Middle wavelength" src="../../../Images/Middle_WL.png"><br></div><br>Ending wavelength :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br><div style="margin-left: 120px;"><img style="width: 260px; height: 80px;" alt="Ending wavelength" src="../../../Images/Ending_WL.png"></div><h2 style="color: rgb(0, 0, 120);"><a name="Description"></a>Description</h2>The application has two tab-windows, &#8216;<span style="color: rgb(0, 70, 200); font-weight: bold;">Define Smoothing Parameters</span>&#8217; in which all smoothing related parameters and options can be specified and &#8216;<span style="font-weight: bold; color: rgb(0, 70, 200);">Apply Smoothing Parameters</span>&#8217; in which the images to be smoothed can be selected.<br><ul><li>Required input for defining the smoothing parameters:</li></ul><ul><ul><li>Use the [<span style="font-weight: bold; color: rgb(0, 70, 200);">Select Image File</span>] button to browse to the hyperspectral image to be smoothed.</li><li>Once the smoothing parameters are defined they can be saved to a file for later use by using the [<span style="font-weight: bold; color: rgb(0, 70, 200);">Save Smoothing params</span>] button.</li><li>Previously saved smoothing parameters can be restored by the [<span style="font-weight: bold; color: rgb(0, 70, 200);">Restore Smoothing params</span>] button.</li></ul></ul><ul><li>Required input for applying the smoothing parameters:</li></ul><ul><ul><li>Use the [<span style="font-weight: bold; color: rgb(0, 70, 200);">Input directory</span>] button to browse to the directory where the hyperspectral images are located which have to be smoothed.</li><li>Use the [<span style="font-weight: bold; color: rgb(0, 70, 200);">Output directory</span>] button to specify the output directory.</li><li>Use the [<span style="font-weight: bold; color: rgb(0, 70, 200);">Start</span>] button to start the actual smoothing process on the highlighted images in the image list.<br></li></ul></ul>Defining the smoothing parameters:<br><ul><li>Once
an image is selected it is displayed in the scroll, image and zoom
window. The image and zoom window can be zoomed in and out. The red
zoom boxes in the scroll and image window can be moved around by
holding the left mouse button while the cursor is within the red canvas.</li><li>As
soon as the image is displayed, the spectral profile for the central
pixel in the zoom box, indicated by the yellow marker, is displayed in
the spectral profile window in a green colour.&nbsp;</li><li>When
defining smoothing parameters, the smoothed spectral profile is
automatically overlaid in a yellow colour. When moving the zoom boxes
around those spectral profiles are updated to the actual pixel location.</li><li>Selecting a range of wavelengths for which a certain smoothing factor has to be assigned can be done in three ways:</li></ul><ol><ol><li>Highlight the required wavelengths in the &#8216;<span style="font-weight: bold; color: rgb(0, 70, 200);">Available bands</span>&#8217; list or highlight the required smoothing factors in the &#8216;<span style="font-weight: bold; color: rgb(0, 70, 200);">Smoothing factors</span>&#8217;
list. Both lists are linked. When a range of wavelengths is selected
the vertical blue lines in the spectral profile window will be
positioned according to the selected wavelength range. The low and high
wavelength limit are displayed left and right of these marker lines.</li><li>By
holding down the left mouse button when positioned on one of the blue
marker lines these can be repositioned to the required wavelength
range. At the same time the corresponding entries in the &#8216;<span style="font-weight: bold; color: rgb(0, 70, 200);">Available bands</span>&#8217; list and &#8216;<span style="font-weight: bold; color: rgb(0, 70, 200);">Smoothing factors</span>&#8217; list are highlighted.</li><li>Use the [<span style="font-weight: bold; color: rgb(0, 70, 200);">Select all</span>] button to select all wavelengths present.<br></li></ol></ol><ul><li>Once the required range of wavelengths is selected, the smoothing factors can be defined. Several options exist:</li></ul><ol><ol><li>Set a certain smooth factor by using the [<span style="font-weight: bold; color: rgb(0, 70, 200);">Set smooth factor</span>]
button. Therefore write a certain smoothing value in the textbox below
this button. The higher the value the stronger the spectral profile
will be smoothed. A zero value will not change the spectral profile for
the selected spectral range. The influence of setting these smoothing
values can directly be observed via the yellow spectral profile.</li><li>A set of wavelengths can be ignored via the [<span style="font-weight: bold; color: rgb(0, 70, 200);">Ignore</span>]
button. This means that those selected wavelength bands are not taken
into account during the smoothing process. This option is quite similar
to setting the smoothing factor to zero, although in that case the
bands are indeed taken into account during the smoothing process.<br></li><li>Selected wavelength bands can be zeroed by the [<span style="font-weight: bold; color: rgb(0, 70, 200);">Zero out</span>] button. The selected bands are simply put to a zero in this case.</li><li>Bands can be removed by the [<span style="font-weight: bold; color: rgb(0, 70, 200);">Remove button</span>].</li><li>A range of selected wavelength bands can be interpolated via the [<span style="font-weight: bold; color: rgb(0, 70, 200);">Interpolate</span>]
button. In this case the selected bands are linear interpolated using
the spectral values in the band preceding and following the selected
spectral range.</li><li>Via the [<span style="font-weight: bold; color: rgb(0, 70, 200);">Clear settings</span>]
button the defined settings can be cleared for the selected spectral
range. This option is identical to setting the smoothing value to zero.<br></li></ol></ol><ul><li>An
option exist to define different smoothing parameters for different
selected areas in one image. This is useful as for example spectral
profiles for vegetation need to be smoothed in a different way as bare
soil has to be smoothed. Therefore different smoothing scenarios can be
defined/removed using the [<span style="font-weight: bold; color: rgb(0, 70, 200);">Add scenario</span>] / [<span style="font-weight: bold; color: rgb(0, 70, 200);">Remove scenario</span>] buttons, as an example a vegetation non-vegetation scenario is explained:</li></ul><ol><ol><li>Create
two masks, one selecting the vegetation the other selecting the
non-vegetation pixels. These masks must have the same name as the
images to be smoothed and must be located in the same directory.</li><li>Each mask must have a unique suffix, e.g. &#8216;<span style="font-weight: bold; color: rgb(0, 70, 200);">_veg</span>&#8217; and &#8216;<span style="font-weight: bold; color: rgb(0, 70, 200);">_nonveg</span>&#8217;.</li><li>Define the smoothing factors for the vegetation pixels, write the suffix name &#8216;<span style="font-weight: bold; color: rgb(0, 70, 200);">_veg</span>&#8217; in the &#8216;Mask suffix&#8217; textbox and use the [<span style="font-weight: bold; color: rgb(0, 70, 200);">Add scenario</span>] button the assign the smoothing factors. The same has to be done for the non-vegetation pixels.<br></li><li>When smoothing is applied the two scenarios will be taken into account.&nbsp;</li></ol></ol><h2 style="color: rgb(0, 0, 120);"><a name="Reference"></a>Reference</h2>The Interactive Spectral Smoothing (ISS) algorithm, L. Bertels, <span style="font-style: italic;">Paper in preparation</span>.<h2 style="color: rgb(0, 0, 120);"><a name="Version_History"></a>Version History</h2><table style="text-align: left; width: 935px; height: 139px;" border="0" cellpadding="4" cellspacing="1"><tbody><tr><td style="background-color: rgb(213, 213, 222);"><span style="font-weight: bold;">Author</span></td><td style="background-color: rgb(213, 213, 222);"><span style="font-weight: bold;">Date</span></td><td style="background-color: rgb(213, 213, 222);"><span style="font-weight: bold;">Description</span></td></tr><tr><td style="background-color: rgb(226, 226, 226); height: 31px;"><a href="../../../Authors%20and%20Contributors.html">LBer</a></td><td style="white-space: nowrap; height: 31px; background-color: rgb(226, 226, 226);">April 2009</td><td style="height: 31px; background-color: rgb(226, 226, 226);">Created</td></tr><tr><td style="background-color: rgb(226, 226, 226); height: 31px;"><a href="../../../Authors%20and%20Contributors.html">LBer</a></td><td style="background-color: rgb(226, 226, 226); height: 31px;">December 2011</td><td style="background-color: rgb(226, 226, 226); height: 31px;">Update: Interactive visualisation of smoothing parameters.</td></tr><tr><td style="background-color: rgb(226, 226, 226); height: 31px;"><a href="../../../Authors%20and%20Contributors.html">LBer</a></td><td style="background-color: rgb(226, 226, 226); height: 31px;">December 2012</td><td style="background-color: rgb(226, 226, 226); height: 31px;">Update: First release for the ENVI /IDL Code Library - OSI.</td></tr></tbody></table></body></html>